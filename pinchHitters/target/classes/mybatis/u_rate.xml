<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="u_rate">
    
	<insert id="create" parameterType="U_RateDTO">
		insert into u_rate(u_num, u_ID, u_content, u_star, u_ratecode, c_ID)
		values(#{u_num}, #{u_ID}, #{u_content}, #{u_star}, #{u_ratecode}, #{c_ID})
	</insert>
	
	<select id="read" parameterType="String" resultType="U_RateDTO">
		select u_num, u_ID, u_content, u_star, u_ratecode, c_ID
		from u_rate
		where u_ID = #{u_ID} or c_ID = #{c_ID}
	</select>
	
	<update id="update" parameterType="String">
		update u_rate
		set u_content = #{u_content}, u_star = #{u_star}, u_ratecode = #{u_ratecode}
		where u_ID = #{u_ID} or c_ID = #{c_ID}
	</update>
	
	<delete id="delete" parameterType="String">
		delete from u_rate
		where u_num = #{u_num}
	</delete>
	
	<select id="list" parameterType="Map" resultType="U_RateDTO">
		select u_num, u_ID, u_content, u_star, u_ratecode, c_ID, r
		from(
			select u_num, u_ID, u_content, u_star, u_ratecode, c_ID, rownum as r
			from c_rate
			<where>
				<choose>
					<when test="col=='u_ID'">
						u_ID like '%'||#{word}||'%'
					</when>
					<when test="col=='c_ID'">
						c_ID like '%'||#{word}||'%'
					</when>
					<when test="col=='u_star'">
						u_star like '%'||#{word}||'%'
					</when>
				</choose>
			</where>
		<![CDATA[
		)where r>=#{sno} and r<=#{eno}
		]]>
	</select>
    
    <select id="total" parameterType="Map" resultType="int">
		select count(*) from u_rate
		<where>
			<choose>
				<when test="col=='u_ID'">
					u_ID like '%'||#{word}||'%'
				</when>
				<when test="col=='c_ID'">
					c_ID like '%'||#{word}||'%'
				</when>
				<when test="col=='u_star'">
					u_star like '%'||#{word}||'%'
				</when>
			</choose>
		</where>
	</select>
	
</mapper>